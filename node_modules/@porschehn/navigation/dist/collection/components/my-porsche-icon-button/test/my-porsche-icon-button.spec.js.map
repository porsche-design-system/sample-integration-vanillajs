{"version":3,"file":"my-porsche-icon-button.spec.js","sourceRoot":"","sources":["../../../../../src/components/my-porsche-icon-button/test/my-porsche-icon-button.spec.tsx"],"names":[],"mappings":"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","sourcesContent":["import { newSpecPage, SpecPage } from '@stencil/core/testing';\nimport { h } from '@stencil/core';\nimport { MyPorscheIconButton } from '../my-porsche-icon-button';\nimport { navStateStore } from '../../../state/nav-state-store';\nimport { getHTMLElement } from '../../../utility/helper';\nimport globalDataLayerService from '../../../services/analytics/global-data-layer-service';\nimport { ClickElementTypes, EventActions } from '../../../utility/constants';\nimport { RoutingKeys } from '../../../entities/routing-key';\nimport * as el from '../../../test/element-helpers';\n\ndescribe('my-porsche-icon-button', () => {\n  async function getPage(): Promise<SpecPage> {\n    return await newSpecPage({\n      components: [MyPorscheIconButton],\n      template: () => <phn-my-porsche-icon-button mode=\"navbar\" theme=\"light\" />\n    });\n  }\n\n  it('should not render an unread message indicator', async () => {\n    const page = await getPage();\n\n    navStateStore.state.unreadMessagesCount = 0;\n\n    await page.waitForChanges();\n\n    expect(page.root).toMatchInlineSnapshot(`\n      <phn-my-porsche-icon-button>\n        <phn-p-button-pure aria=\"{ 'aria-haspopup': 'dialog', 'aria-label' : 'open the my porsche menu' }\" data-id=\"my_porsche-contextual-button\" data-test-id=\"myporsche-button\" hide-label=\"true\" icon=\"user\" stretch=\"true\" theme=\"light\"></phn-p-button-pure>\n      </phn-my-porsche-icon-button>\n    `);\n  });\n\n  it('should render an unread message indicator', async () => {\n    const page = await getPage();\n\n    navStateStore.state.unreadMessagesCount = 22;\n\n    await page.waitForChanges();\n\n    expect(page.root).toMatchInlineSnapshot(`\n      <phn-my-porsche-icon-button>\n        <phn-p-button-pure aria=\"{ 'aria-haspopup': 'dialog', 'aria-label' : 'open the my porsche menu' }\" data-id=\"my_porsche-contextual-button\" data-test-id=\"myporsche-button\" hide-label=\"true\" icon=\"user\" stretch=\"true\" theme=\"light\"></phn-p-button-pure>\n        <span class=\"light myporsche-unread-messages-indicator\"></span>\n      </phn-my-porsche-icon-button>\n    `);\n  });\n\n  describe('user is logged out', () => {\n    it('display default user icon', async () => {\n      const page = await getPage();\n      const myPorscheButton = getHTMLElement(page.root?.querySelector('[data-test-id=\"myporsche-button\"]'));\n\n      expect(myPorscheButton?.getAttribute('icon-source')).toBeNull();\n      expect(page.rootInstance.isMyPorscheHoveredOn).toBe(false);\n    });\n\n    it('display red user icon when hovering over button', async () => {\n      const page = await getPage();\n      const myPorscheButton = getHTMLElement(page.root?.querySelector('[data-test-id=\"myporsche-button\"]'));\n\n      el.mouseEnter(myPorscheButton);\n\n      await page.waitForChanges();\n\n      expect(page.rootInstance.isMyPorscheHoveredOn).toBe(true);\n      expect(myPorscheButton?.getAttribute('icon-source')).toBeNull();\n\n      el.mouseLeave(myPorscheButton);\n\n      await page.waitForChanges();\n\n      expect(page.rootInstance.isMyPorscheHoveredOn).toBe(false);\n      expect(myPorscheButton?.getAttribute('icon-source')).toBeNull();\n    });\n  });\n\n  describe('user is logged in', () => {\n    beforeEach(async () => {\n      navStateStore.state.loggedInState = 'Mirinda Doe';\n    });\n\n    it('display filled version of user icon', async () => {\n      const page = await getPage();\n      const myPorscheButton = getHTMLElement(page.root?.querySelector('[data-test-id=\"myporsche-button\"]'));\n\n      expect(myPorscheButton?.getAttribute('icon')).toEqual('user-filled');\n      expect(page.rootInstance.isMyPorscheHoveredOn).toBe(false);\n    });\n  });\n\n  describe('data analytics', () => {\n    it('should send event after clicking on myporsche button', async () => {\n      const page = await getPage();\n\n      const myPorscheButton = getHTMLElement(page.root?.querySelector('[data-test-id=\"myporsche-button\"]'));\n\n      myPorscheButton?.click();\n      await page.waitForChanges();\n\n      const event = globalDataLayerService.gdl.DataLayerStore[0];\n\n      expect(event.context?.eventAction).toEqual(EventActions.CONTEXTUAL_BUTTON_CLICK);\n      expect(event.componentClick).toEqual({\n        clickElementId: RoutingKeys.MY_PORSCHE,\n        clickElementName: 'open the my porsche menu',\n        clickElementType: ClickElementTypes.Button\n      });\n    });\n  });\n});\n"]}