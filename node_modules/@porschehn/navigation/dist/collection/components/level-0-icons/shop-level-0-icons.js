import { h } from "@stencil/core";
import { isShopAvailable } from "../../utility/helpers/shop-helper";
import animationManager from "../../services/animations/animation-manager";
import { getRightTheme } from "../../utility/helper";
import { navContentStore } from "../../state/nav-content-store";
import { pureButtonSkeleton } from "../../utility/skeleton";
import { EventActions, NavigationMode, NavigationTheme } from "../../utility/constants";
import { shopStateStore } from "../../state/shop-state-store";
import globalDataLayerService from "../../services/analytics/global-data-layer-service";
export default function shopIcons({ locale, app, mode, theme, isNavigationLoaded }) {
  function getShoppingCartLink() {
    var _a;
    const shopLink = (_a = navContentStore.state.shop) === null || _a === void 0 ? void 0 : _a.cart;
    if (shopLink !== undefined && shopLink !== '') {
      return `${shopLink}`;
    }
    return '';
  }
  function showShoppingCart() {
    const { numberOfShoppingItems, shopInformation } = shopStateStore.state;
    let numberOfItems = shopInformation.numberOfShoppingItems;
    if (numberOfItems === 0) {
      numberOfItems = numberOfShoppingItems;
    }
    switch (true) {
      case numberOfItems === 0:
        return 'shopping-bag';
      case numberOfItems > 0:
        return 'shopping-bag-filled';
      default:
        return 'shopping-bag';
    }
  }
  function getAriaLabelForShoppingCart() {
    const { shopInformation } = shopStateStore.state;
    return `My shopping bag, ${shopInformation.numberOfShoppingItems} items, estimated subtotal ${shopInformation.subTotal}`;
  }
  return {
    leftIcons: isShopAvailable(locale, app) ? (h("div", { class: "icon" }, h("phn-p-button-pure", { icon: "search", "hide-label": "true", stretch: "true", aria: "{ 'aria-haspopup': 'dialog', 'aria-label' : 'open the shop search field' }", "data-test-id": "search-button", onClick: () => {
        animationManager.play('openContextualDrawer');
        sendDataLayerEventContextualDrawer();
      }, style: isNavigationLoaded ? {} : { display: 'none' }, theme: getRightTheme(theme, mode) }), !isNavigationLoaded ? pureButtonSkeleton() : null)) : null,
    rightIcons: isShopAvailable(locale, app) ? (h("div", { class: "icon" }, h("phn-p-link-pure", { target: '_self', "hide-label": "true", icon: "none", theme: getRightTheme(theme, mode), style: isNavigationLoaded ? {} : { display: 'none' }, class: "shopping-cart-link", "data-test-id": "shopping-cart-link", onClick: () => {
        sendDataLayerEventShoppingCart(getShoppingCartLink());
      } }, h("a", { href: getShoppingCartLink(), "aria-label": getAriaLabelForShoppingCart() }, h("div", { class: "icon-flex" }, h(ShoppingCartCount, { styleClass: "shopping-item-count", theme: theme, mode: mode }), h("phn-p-icon", { theme: getRightTheme(theme, mode), name: showShoppingCart(), "data-test-id": "shopping-cart-link-icon" })))), !isNavigationLoaded ? pureButtonSkeleton() : null)) : null
  };
}
const ShoppingCartCount = ({ styleClass, theme, mode }) => {
  const shoppingItemCountOver99 = '+99';
  const { numberOfShoppingItems, shopInformation } = shopStateStore.state;
  let numberOfItems = shopInformation.numberOfShoppingItems;
  if (numberOfItems === 0) {
    numberOfItems = numberOfShoppingItems;
  }
  const displayedCount = numberOfItems < 99 ? numberOfItems : shoppingItemCountOver99;
  if (numberOfItems <= 0)
    return '';
  return (h("span", { class: styleClass, style: mode === NavigationMode.hero && theme === NavigationTheme.dark ? { color: 'black' } : { color: 'white' } }, displayedCount));
};
function sendDataLayerEventContextualDrawer() {
  globalDataLayerService.pushDataLayerEvent(EventActions.CONTEXTUAL_BUTTON_CLICK, {
    componentClick: {
      clickElementId: 'mainmenu.shop.search',
      clickElementName: 'Shop search'
    }
  });
}
function sendDataLayerEventShoppingCart(url) {
  globalDataLayerService.pushDataLayerEvent(EventActions.CONTEXTUAL_BUTTON_CLICK, {
    componentClick: {
      clickElementId: 'mainmenu.shop.shoppingbag',
      clickElementName: 'Shopping cart',
      targetUrl: url
    }
  });
}
//# sourceMappingURL=shop-level-0-icons.js.map
