{"version":3,"file":"dealer-search-form.spec.js","sourceRoot":"","sources":["../../../../../src/components/dealer-search-form/test/dealer-search-form.spec.tsx"],"names":[],"mappings":"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","sourcesContent":["import { h } from '@stencil/core';\nimport { newSpecPage } from '@stencil/core/testing';\nimport { dealerSearchResultsStore } from '../../../state/dealer-search-results-store';\nimport { navContentStore } from '../../../state/nav-content-store';\nimport {\n  mockDealerContent,\n  mockPPNDealerOneSearchResults,\n  mockPPNDealerSearchResultsWithLocalizedAddress,\n  mockPredictions\n} from '../../../test/test-data';\nimport { getHTMLElement, getHTMLInputElement } from '../../../utility/helper';\nimport { DealerSearchForm } from '../dealer-search-form';\nimport { DealerSearchFormGeolocation } from '../../dealer-search-form-geolocation/dealer-search-form-geolocation';\nimport { DealerSearchResults } from '../../dealer-search-results/dealer-search-results';\nimport { DealerSearchByNumberOfDealers } from '../../dealer-search-by-number-of-dealers/dealer-search-by-number-of-dealers';\nimport { DealerSearchFormDropdown } from '../../dealer-search-form-dropdown/dealer-search-form-dropdown';\n\njest.mock('../../../services/maps-service.ts');\n\ndescribe('Dealer Search Form', () => {\n  const defaultProps = {\n    dealer: mockDealerContent,\n    locale: 'xx-XX',\n    breakpoint: 0\n  };\n\n  beforeEach(async () => {\n    dealerSearchResultsStore.state.results = mockPPNDealerSearchResultsWithLocalizedAddress.map(\n      ({ ppnDealer: dealer }) => dealer.id\n    );\n    dealerSearchResultsStore.state.ppnDealers = mockPPNDealerSearchResultsWithLocalizedAddress.reduce(\n      (ppnDealers, dealerSearchResult) => ({\n        ...ppnDealers,\n        [dealerSearchResult.ppnDealer.id]: dealerSearchResult\n      }),\n      {}\n    );\n\n    navContentStore.state.dealer.numberOfDealers = 6;\n  });\n\n  const getPage = async (props = defaultProps) => {\n    return await newSpecPage({\n      components: [\n        DealerSearchForm,\n        DealerSearchResults,\n        DealerSearchFormGeolocation,\n        DealerSearchByNumberOfDealers,\n        DealerSearchFormDropdown\n      ],\n      template: () => <phn-dealer-search-form {...props} />\n    });\n  };\n\n  describe('form strategy', () => {\n    it('should render geolocation strategy', async () => {\n      const page = await getPage();\n      const element = getHTMLElement(page.root?.querySelector('phn-dealer-search-form-geolocation'));\n\n      expect(element).not.toBeUndefined();\n    });\n\n    it('should render dropdown strategy', async () => {\n      const page = await getPage({ ...defaultProps, locale: 'zh-CN' });\n      const element = getHTMLElement(page.root?.querySelector('phn-dealer-search-form-dropdown'));\n\n      expect(element).not.toBeUndefined();\n    });\n\n    it('should render by number of dealers strategy', async () => {\n      navContentStore.set('dealer', { ...navContentStore.state.dealer, numberOfDealers: 5 });\n\n      const page = await getPage();\n\n      const element = getHTMLElement(page.root?.querySelector('phn-dealer-search-by-number-of-dealers'));\n\n      expect(element).not.toBeUndefined();\n    });\n  });\n\n  describe('snapshot testing', () => {\n    it('should render dealer search without heading on desktop', async () => {\n      dealerSearchResultsStore.state.results = mockPPNDealerSearchResultsWithLocalizedAddress.map(\n        ({ ppnDealer: dealer }) => dealer.id\n      );\n      dealerSearchResultsStore.state.ppnDealers = mockPPNDealerSearchResultsWithLocalizedAddress.reduce(\n        (ppnDealers, dealerSearchResult) => ({\n          ...ppnDealers,\n          [dealerSearchResult.ppnDealer.id]: dealerSearchResult\n        }),\n        {}\n      );\n      navContentStore.set('dealer', mockDealerContent);\n      const page = await getPage();\n\n      expect(page.root).toMatchInlineSnapshot(`\n        <phn-dealer-search-form>\n          <phn-dealer-search-form-geolocation class=\"skeleton\">\n            <div class=\"input-container\">\n              <div class=\"skeleton-autocomplete-search-field\"></div>\n              <phn-autocomplete-search-field errormessage=\"\" initialvalue=\"\" placeholder=\"Location\" style=\"display: none;\"></phn-autocomplete-search-field>\n            </div>\n          </phn-dealer-search-form-geolocation>\n          <phn-dealer-search-results>\n            <phn-menu-item-card analyticsid=\"6a6d8e8c-5b04-4a4b-a119-66021b528788\" class=\"animated dealer-card\" tabindex=\"0\" text=\"localized Porsche Zentrum Stuttgart\">\n              <div class=\"phn-align-center phn-flex-row phn-justify-between\">\n                <phn-p-text color=\"primary\" size=\"small\">\n                  localized Porscheplatz 9,\n                  <span class=\"city\">\n                    70435 localized Stuttgart\n                  </span>\n                </phn-p-text>\n                <phn-p-tag color=\"notification-info-soft\">\n                  3km\n                </phn-p-tag>\n              </div>\n            </phn-menu-item-card>\n            <phn-menu-item-card analyticsid=\"14f3b8a2-b78d-4f96-b7b5-123124\" class=\"animated dealer-card\" tabindex=\"0\" text=\"localized Porsche Zentrum Stuttgart-Flughafen\">\n              <div class=\"phn-align-center phn-flex-row phn-justify-between\">\n                <phn-p-text color=\"primary\" size=\"small\">\n                  localized Porscheplatz 9,\n                  <span class=\"city\">\n                    70794 localized Stuttgart\n                  </span>\n                </phn-p-text>\n                <phn-p-tag color=\"notification-info-soft\">\n                  2km\n                </phn-p-tag>\n              </div>\n            </phn-menu-item-card>\n            <phn-menu-item-card analyticsid=\"14f3b8a2-b78d-4f96-b7b5-7b1b4723323542\" class=\"animated dealer-card\" tabindex=\"0\" text=\"localized Porsche Zentrum Böblingen\">\n              <div class=\"phn-align-center phn-flex-row phn-justify-between\">\n                <phn-p-text color=\"primary\" size=\"small\">\n                  localized Porscheplatz 9,\n                  <span class=\"city\">\n                    71034 localized Stuttgart\n                  </span>\n                </phn-p-text>\n                <phn-p-tag color=\"notification-info-soft\">\n                  4km\n                </phn-p-tag>\n              </div>\n            </phn-menu-item-card>\n            <phn-menu-item-card analyticsid=\"14f3b8a2-b78d-4f96-b7b5-7b1b453b23542\" class=\"animated dealer-card\" tabindex=\"0\" text=\"localized Porsche Zentrum Reutlingen\">\n              <div class=\"phn-align-center phn-flex-row phn-justify-between\">\n                <phn-p-text color=\"primary\" size=\"small\">\n                  localized Porscheplatz 9,\n                  <span class=\"city\">\n                    72770 localized Stuttgart\n                  </span>\n                </phn-p-text>\n                <phn-p-tag color=\"notification-info-soft\">\n                  2km\n                </phn-p-tag>\n              </div>\n            </phn-menu-item-card>\n            <phn-menu-item-card analyticsid=\"14f3b8a2-b78d-4f96-b7b5-7b11b23542\" class=\"animated dealer-card\" tabindex=\"0\" text=\"localized Porsche Zentrum Göppingen\">\n              <div class=\"phn-align-center phn-flex-row phn-justify-between\">\n                <phn-p-text color=\"primary\" size=\"small\">\n                  localized Porscheplatz 9,\n                  <span class=\"city\">\n                    73037 localized Stuttgart\n                  </span>\n                </phn-p-text>\n                <phn-p-tag color=\"notification-info-soft\">\n                  1km\n                </phn-p-tag>\n              </div>\n            </phn-menu-item-card>\n            <phn-menu-item-card analyticsid=\"36e8fba0-e931-11dc-ada3-c822588bbdee\" class=\"animated dealer-card\" tabindex=\"0\" text=\"localized Porsche Zentrum Stuttgart\">\n              <div class=\"phn-align-center phn-flex-row phn-justify-between\">\n                <phn-p-text color=\"primary\" size=\"small\">\n                  localized Porscheplatz 9,\n                  <span class=\"city\">\n                    70435 localized Stuttgart\n                  </span>\n                </phn-p-text>\n              </div>\n            </phn-menu-item-card>\n            <a aria-label=\"\" class=\"animated\" href=\"http://www.porsche.com/all-dealers-map\">\n              <phn-p-button variant=\"tertiary\">\n                All Dealers Map\n              </phn-p-button>\n            </a>\n          </phn-dealer-search-results>\n        </phn-dealer-search-form>\n      `);\n    });\n\n    it('should render dealer search form with 1 dealer available', async () => {\n      dealerSearchResultsStore.state.results = mockPPNDealerOneSearchResults.map(({ ppnDealer: dealer }) => dealer.id);\n      dealerSearchResultsStore.state.ppnDealers = mockPPNDealerOneSearchResults.reduce(\n        (ppnDealers, dealerSearchResult) => ({\n          ...ppnDealers,\n          [dealerSearchResult.ppnDealer.id]: dealerSearchResult\n        }),\n        {}\n      );\n      navContentStore.set('dealer', mockDealerContent);\n      const page = await getPage();\n\n      expect(page.root).toMatchInlineSnapshot(`\n        <phn-dealer-search-form>\n          <phn-dealer-search-form-geolocation class=\"skeleton\">\n            <div class=\"input-container\">\n              <div class=\"skeleton-autocomplete-search-field\"></div>\n              <phn-autocomplete-search-field errormessage=\"\" initialvalue=\"\" placeholder=\"Location\" style=\"display: none;\"></phn-autocomplete-search-field>\n            </div>\n          </phn-dealer-search-form-geolocation>\n          <phn-dealer-search-results>\n            <phn-dealer-details-drawer breakpoint=\"0\" dealerid=\"6a6d8e8c-5b04-4a4b-a119-66021b528788\" locale=\"xx-XX\"></phn-dealer-details-drawer>\n          </phn-dealer-search-results>\n        </phn-dealer-search-form>\n      `);\n    });\n\n    it('should render dealer search form without results if dealers result is empty', async () => {\n      navContentStore.set('dealer', mockDealerContent);\n      dealerSearchResultsStore.state.results = null;\n\n      const page = await getPage();\n\n      expect(page.root).toMatchInlineSnapshot(`\n        <phn-dealer-search-form>\n          <phn-dealer-search-form-geolocation class=\"skeleton\">\n            <div class=\"input-container\">\n              <div class=\"skeleton-autocomplete-search-field\"></div>\n              <phn-autocomplete-search-field errormessage=\"\" initialvalue=\"\" placeholder=\"Location\" style=\"display: none;\"></phn-autocomplete-search-field>\n            </div>\n            <div class=\"or-container\">\n              <div class=\"skeleton-or-text\"></div>\n              <phn-p-text color=\"inherit\" data-test-id=\"dealer-search-or-label\" size=\"inherit\" tag=\"div\" style=\"display: none;\">\n                Or\n              </phn-p-text>\n              <div class=\"skeleton-geolocation-button\"></div>\n              <phn-p-button class=\"geolocation\" icon=\"locate\" variant=\"tertiary\" style=\"display: none;\">\n                Current location\n              </phn-p-button>\n            </div>\n          </phn-dealer-search-form-geolocation>\n          <phn-dealer-search-results></phn-dealer-search-results>\n        </phn-dealer-search-form>\n      `);\n    });\n  });\n\n  describe('Autocompletion', () => {\n    it('should show opacity overlay on result cards, if autocomplete predictions and results are shown', async () => {\n      const page = await getPage();\n      const inputField = getHTMLInputElement(page.root?.querySelector('phn-autocomplete-search-field'));\n      inputField?.dispatchEvent(new CustomEvent('submitSearch', { detail: mockPredictions[0] }));\n\n      await page.waitForChanges();\n\n      expect(page.root?.querySelector('.dealer-card')).not.toBeNull();\n      expect(page.root?.querySelector('.dealer-card-overlay')).toBeNull();\n\n      page.root?.dispatchEvent(new CustomEvent('predictionsToggle', { detail: true }));\n\n      await page.waitForChanges();\n\n      expect(page.root?.querySelector('.dealer-card-overlay')).not.toBeNull();\n    });\n  });\n});\n"]}