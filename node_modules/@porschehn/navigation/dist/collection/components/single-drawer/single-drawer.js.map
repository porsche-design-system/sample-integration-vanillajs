{"version":3,"file":"single-drawer.js","sourceRoot":"","sources":["../../../../src/components/single-drawer/single-drawer.tsx"],"names":[],"mappings":"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","sourcesContent":["import { Component, Element, Event, EventEmitter, h, Host, Listen, Prop, State } from '@stencil/core';\nimport { RoutingKeyPointers, RoutingKeys } from '../../entities/routing-key';\nimport animationManager from '../../services/animations/animation-manager';\nimport globalDataLayerService from '../../services/analytics/global-data-layer-service';\nimport {\n  AnimationSequences,\n  DisplayElementTypes,\n  ElementTypes,\n  EventActions,\n  FOCUSABLE_ELEMENTS_SELECTOR\n} from '../../utility/constants';\nimport { focusOnElement, getHTMLElement, isPromise, isString } from '../../utility/helper';\nimport { Timeout } from '../../utility/timeout';\nimport DrawerContent from './drawer-content';\nimport {\n  isPlayingSingleDrawerAnimation,\n  registerCloseSingleDrawerAnimation,\n  registerOpenSingleDrawerAnimation,\n  registerTransitionNextLevelSingleDrawerAnimation,\n  registerTransitionPreviousLevelSingleDrawerAnimation\n} from './single-drawer-animation-sequences';\nimport analyticsManager from '../../services/analytics/analytics-manager';\nimport { DrawerStatusTypes, DrawerStatusValues } from '../../utility/constants/app';\nimport { getAllFocusableElements } from '../double-drawer/helper';\n\n// INFO: For routing explanation, see README in this directory\n\n@Component({\n  tag: 'phn-single-drawer',\n  scoped: true,\n  styleUrl: 'single-drawer.scss'\n})\nexport class SingleDrawer {\n  @Prop() breakpoint!: number;\n  @Prop() locale!: string;\n  @Prop() usingKeyboard = false;\n  @Prop() routingKeyHistory!: string[];\n  @Prop() routingKeyPointer!: number;\n  @Prop() receivedContent = false;\n\n  @State() animatingPointer = -1;\n\n  @Event() drawerClosed!: EventEmitter<void>;\n  @Event() drawerChanged!: EventEmitter<boolean>;\n  @Event() drawerStartsClosing!: EventEmitter<void>;\n  @Event() backdropClosed!: EventEmitter<void>;\n  @Event({ composed: true, bubbles: true }) phnDrawerStatus!: EventEmitter<{\n    status: DrawerStatusTypes;\n  }>;\n\n  @Element() el!: HTMLPhnSingleDrawerElement;\n\n  private focusTimeout = new Timeout(0);\n  private operationPipeline: ((() => Promise<void>) | (() => void))[] = [];\n\n  @Listen('keydown', { passive: false })\n  handleKeyDown(e: KeyboardEvent): void {\n    if (e.key !== 'Tab') {\n      return;\n    }\n\n    const targetElement = getHTMLElement(e.target);\n    if (targetElement === null) {\n      return;\n    }\n\n    let focusableDrawerElements = getAllFocusableElements(this.el.querySelector('.active'));\n    if (focusableDrawerElements.length === 0) {\n      return;\n    }\n\n    const activeRoutingKey = this.routingKeyHistory[this.routingKeyPointer];\n    if (activeRoutingKey.startsWith(RoutingKeys.DEALER_SEARCH)) {\n      focusableDrawerElements = focusableDrawerElements.filter(\n        (element) => element.nodeName !== 'BUTTON' && element.nodeName !== 'A'\n      );\n    }\n\n    const firstFocusableDrawerElement = focusableDrawerElements[0];\n    const lastFocusableDrawerElement = focusableDrawerElements[focusableDrawerElements.length - 1];\n\n    if (targetElement === firstFocusableDrawerElement && e.shiftKey) {\n      e.preventDefault();\n\n      if (lastFocusableDrawerElement !== null) {\n        focusOnElement(lastFocusableDrawerElement);\n      }\n\n      return;\n    }\n\n    if (targetElement === lastFocusableDrawerElement && !e.shiftKey) {\n      e.preventDefault();\n\n      if (firstFocusableDrawerElement !== null) {\n        focusOnElement(firstFocusableDrawerElement);\n      }\n\n      return;\n    }\n  }\n\n  @Listen('mobileMenuItemClick')\n  handleMobileMenuItemClick(e: MouseEvent): void {\n    if (isPlayingSingleDrawerAnimation()) {\n      e.stopPropagation();\n      return;\n    }\n    this.animatingPointer = this.routingKeyPointer;\n  }\n\n  @Listen('clickDrawerHeaderClose')\n  handleClickDrawerHeaderClose(e: MouseEvent): void {\n    if (isPlayingSingleDrawerAnimation()) {\n      e.stopPropagation();\n      return;\n    }\n  }\n\n  @Listen('clickDrawerHeaderBack')\n  handleClickDrawerHeaderBack(e: MouseEvent): void {\n    if (isPlayingSingleDrawerAnimation()) {\n      e.stopPropagation();\n      return;\n    }\n    this.animatingPointer = this.routingKeyPointer;\n  }\n\n  private onTransitionEnd() {\n    const focussedElementId =\n      this.animatingPointer > this.routingKeyPointer ? this.routingKeyHistory[this.animatingPointer] : '';\n\n    this.animatingPointer = this.routingKeyPointer;\n\n    const isNavigatingBackwards = this.routingKeyPointer < this.routingKeyHistory.length - 1;\n    this.drawerChanged.emit(isNavigatingBackwards);\n\n    // Focus needs to happen after rerender, so wait for next tick\n    this.focusTimeout.set(async () => {\n      this.focusOnActiveDrawer(focussedElementId);\n    });\n    this.sendDataLayerEvent();\n  }\n\n  componentWillLoad(): void {\n    registerOpenSingleDrawerAnimation({\n      onAnimationStarts: () => {\n        this.phnDrawerStatus.emit({ status: DrawerStatusValues.startOpening });\n      },\n      onAnimationEnds: () => {\n        this.onTransitionEnd();\n        this.phnDrawerStatus.emit({ status: DrawerStatusValues.finishOpening });\n      }\n    });\n    registerCloseSingleDrawerAnimation({\n      onAnimationStarts: () => {\n        this.phnDrawerStatus.emit({ status: DrawerStatusValues.startClosing });\n      },\n      onAnimationEnds: () => {\n        this.backdropClosed.emit();\n        this.phnDrawerStatus.emit({ status: DrawerStatusValues.finishClosing });\n      }\n    });\n    registerTransitionNextLevelSingleDrawerAnimation({\n      onAnimationEnds: () => this.onTransitionEnd()\n    });\n    registerTransitionPreviousLevelSingleDrawerAnimation({ onAnimationEnds: () => this.onTransitionEnd() });\n  }\n\n  private focusOnActiveDrawer(focussedElementId: string): void {\n    const autoFocusElement = getHTMLElement(this.el.querySelector('.active .autofocus'));\n    if (autoFocusElement !== null) {\n      focusOnElement(autoFocusElement);\n      return;\n    }\n\n    if (this.usingKeyboard) {\n      let focussableElement: HTMLElement | null = null;\n\n      if (isString(focussedElementId)) {\n        focussableElement = getHTMLElement(this.el.querySelector(`.active [data-id=\"${focussedElementId}\"]`));\n      }\n\n      if (focussableElement === null) {\n        focussableElement = getHTMLElement(this.el.querySelector(`.active ${FOCUSABLE_ELEMENTS_SELECTOR}`));\n      }\n\n      if (focussableElement !== null) {\n        focusOnElement(focussableElement);\n      }\n    } else {\n      //Todo: Why first-focus class? We have it nowhere\n      const firstFocus = getHTMLElement(this.el.querySelector('.first-focus'));\n\n      if (firstFocus !== null) {\n        focusOnElement(firstFocus);\n      }\n    }\n  }\n\n  private sendDataLayerEvent() {\n    analyticsManager.setDrawerType(DisplayElementTypes.SingleDrawer);\n    const activeRoutingKey = this.routingKeyHistory[this.routingKeyPointer];\n\n    globalDataLayerService.pushDataLayerEvent(EventActions.DRAWER_LOAD, {\n      componentDisplay: {\n        displayElementType: analyticsManager.calculateDisplayElementType(activeRoutingKey, ElementTypes.singleDrawer),\n        displayElementId: analyticsManager.calculateDisplayElementId(),\n        displayElementName: 'Single Drawer'\n      }\n    });\n  }\n\n  disconnectedCallback(): void {\n    this.focusTimeout.cancel();\n  }\n\n  async componentDidRender(): Promise<void> {\n    const promises = [];\n    for (const operation of this.operationPipeline) {\n      const maybePromise = operation();\n      if (isPromise<void>(maybePromise)) {\n        promises.push(maybePromise);\n      }\n    }\n\n    await Promise.all(promises);\n    this.operationPipeline.splice(0, this.operationPipeline.length);\n  }\n\n  render(): HTMLPhnSingleDrawerElement {\n    const isAnimatingForward = this.routingKeyPointer > this.animatingPointer;\n    const isAnimatingBackward = this.routingKeyPointer < this.animatingPointer;\n\n    let topDrawerContentPointer = -1;\n    let bottomDrawerContentPointer = this.routingKeyPointer;\n\n    if (isAnimatingForward && this.animatingPointer !== RoutingKeyPointers.LEVEL_ZERO) {\n      topDrawerContentPointer = this.routingKeyPointer;\n      bottomDrawerContentPointer = this.animatingPointer;\n\n      this.operationPipeline.push(async () => {\n        animationManager.play(AnimationSequences.TRANSITION_NEXT_LEVEL_SINGLE_DRAWER);\n      });\n    } else if (isAnimatingBackward) {\n      topDrawerContentPointer = this.animatingPointer;\n\n      if (bottomDrawerContentPointer !== RoutingKeyPointers.LEVEL_ZERO) {\n        this.operationPipeline.push(async () => {\n          animationManager.play(AnimationSequences.TRANSITION_PREVIOUS_LEVEL_SINGLE_DRAWER);\n        });\n      }\n    }\n\n    const animatingRoutingKey = this.routingKeyHistory[topDrawerContentPointer] ?? '';\n    const routingKey = this.routingKeyHistory[bottomDrawerContentPointer] ?? '';\n\n    return (\n      <Host>\n        {isString(routingKey) ? (\n          <div class=\"drawer active\" key={routingKey}>\n            <span class=\"first-focus\" tabIndex={-1} aria-hidden=\"true\" />\n\n            <DrawerContent\n              routingKey={routingKey}\n              previousRoutingKey={this.routingKeyHistory[bottomDrawerContentPointer - 1]}\n              breakpoint={this.breakpoint}\n              locale={this.locale}\n              showBackButton={bottomDrawerContentPointer > 0}\n              receivedContent={this.receivedContent}\n            />\n          </div>\n        ) : null}\n\n        {isString(animatingRoutingKey) ? (\n          <div class={`drawer animating`} style={isAnimatingForward ? { left: '100%' } : {}} key={animatingRoutingKey}>\n            <DrawerContent\n              routingKey={animatingRoutingKey}\n              previousRoutingKey={this.routingKeyHistory[topDrawerContentPointer - 1]}\n              breakpoint={this.breakpoint}\n              locale={this.locale}\n              showBackButton={topDrawerContentPointer > 0}\n              receivedContent={this.receivedContent}\n            />\n          </div>\n        ) : null}\n      </Host>\n    );\n  }\n}\n"]}