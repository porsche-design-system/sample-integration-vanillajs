{"file":"shop-helper.js","mappings":"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","names":[],"sources":["src/state/shop-state-store.ts","src/utility/helpers/shop-helper.ts"],"sourcesContent":["import { createStore } from '@stencil/store';\n\nexport interface ShopInformation {\n  numberOfShoppingItems: number;\n  wishlistItemsNumber: number;\n  subTotal: string;\n}\n\nexport interface ShopStateStoreTypes {\n  wishlistItemsNumber: number;\n  numberOfShoppingItems: number;\n  shopInformation: ShopInformation;\n}\n\nexport const shopStateStore = createStore<ShopStateStoreTypes>({\n  wishlistItemsNumber: 0,\n  numberOfShoppingItems: 0,\n  shopInformation: { numberOfShoppingItems: 0, wishlistItemsNumber: 0, subTotal: '0' }\n});\n","import { Application, ApplicationType } from '../constants/app';\nimport { Content, TLink, TShopAdditionalContentMenu, TShopAuthStatus, TShopMenu } from '../../entities/content';\nimport { getUsername } from '../helper';\nimport { navStateStore } from '../../state/nav-state-store';\nimport { navContentStore } from '../../state/nav-content-store';\nimport { shopStateStore, ShopStateStoreTypes } from '../../state/shop-state-store';\n\nexport function isShopAvailable(locale: string, app: ApplicationType): boolean {\n  const shopList = navContentStore.state.shop?.availableLocales;\n  return shopList !== undefined && shopList.includes(locale) && app === Application.shop;\n}\n\nfunction logoLinksToShop(locale: string): boolean {\n  return navContentStore.state.shop?.logoLinksToShopLocales?.includes(locale) || false;\n}\n\nexport function isShopAvailableAndLogoLinksToShop(\n  locale: string,\n  app: ApplicationType,\n  shop: TShopMenu | null\n): shop is TShopMenu {\n  return isShopAvailable(locale, app) && logoLinksToShop(locale) && shop !== null;\n}\n\nexport function modifyShopItemDependingOnMarket(\n  locale: string,\n  app: ApplicationType | undefined,\n  content: Content\n): Content {\n  const { shop, externalShop } = content;\n\n  if (shop === null) return content;\n\n  if (externalShop && app !== Application.shop) {\n    return replaceShopWithExternalShop(content, shop, externalShop);\n  }\n\n  if (shopNotAvailableOnGlobalPages(shop, locale, app)) {\n    return removeShopItemFromContent(content, shop);\n  }\n\n  return content;\n}\n\nfunction replaceShopWithExternalShop(content: Content, shop: TShopMenu, externalShop: TLink): Content {\n  return {\n    ...content,\n    shop: {\n      ...shop,\n      ...externalShop\n    }\n  };\n}\n\nfunction shopNotAvailableOnGlobalPages(shop: TShopMenu, locale: string, app: ApplicationType | undefined) {\n  return (\n    !shop?.availableLocales.includes(locale) ||\n    (shop?.availableLocalesOnlyForShop.includes(locale) && app !== Application.shop)\n  );\n}\n\nfunction removeShopItemFromContent(content: Content, shop: TShopMenu) {\n  return {\n    ...content,\n    shop: {\n      ...shop,\n      text: ''\n    }\n  };\n}\n\nexport function filterWishlistItemsByAuthStatus(\n  menuItems: TShopAdditionalContentMenu[],\n  authStatusList: TShopAuthStatus[]\n): TShopAdditionalContentMenu[] {\n  return menuItems?.filter((item) => {\n    if (item.authStatus === null || item.authStatus === undefined) {\n      return authStatusList.includes(null);\n    }\n\n    return authStatusList.includes(item.authStatus);\n  });\n}\n\nexport function getAvailableShopVariables(): { wishlistItemsNumber: number; username: string } {\n  const { myPorsche } = navContentStore.state;\n  const { loggedInState } = navStateStore.state;\n  let { wishlistItemsNumber } = shopStateStore.state.shopInformation;\n\n  if (wishlistItemsNumber === 0) {\n    wishlistItemsNumber = shopStateStore.state.wishlistItemsNumber;\n  }\n\n  const username = getUsername(loggedInState, myPorsche?.loggedInFallback || '');\n\n  return { wishlistItemsNumber, username };\n}\n\nexport function loadsShopPropsOnStore(props: ShopStateStoreTypes): void {\n  shopStateStore.set('wishlistItemsNumber', props.wishlistItemsNumber);\n  shopStateStore.set('numberOfShoppingItems', props.numberOfShoppingItems);\n  shopStateStore.set('shopInformation', props.shopInformation);\n}\n\nfunction getWishlistIconName(): string {\n  const { shopInformation } = shopStateStore.state;\n  const { wishlistItemsNumber } = shopStateStore.state;\n  const wishlistNumber =\n    shopInformation.wishlistItemsNumber > 0 ? shopInformation.wishlistItemsNumber : wishlistItemsNumber;\n\n  return wishlistNumber > 0 ? 'heart-filled' : 'heart';\n}\n\nexport function getIconNameByMenuItemId(id: string): string | null {\n  const iconsGetterFunctions: Record<string, () => string> = {\n    wishlist: getWishlistIconName\n  };\n\n  const getIconName = iconsGetterFunctions[id];\n\n  if (typeof getIconName !== 'function') return null;\n\n  return getIconName();\n}\n"],"version":3}