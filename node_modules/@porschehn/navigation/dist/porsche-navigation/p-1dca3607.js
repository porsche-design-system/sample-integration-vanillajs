import{s as n,i as o}from"./p-b43baa04.js";import{A as t,e,N as a,a as c,b as s}from"./p-f7be0ef8.js";import{m as r}from"./p-fd04cc51.js";import{f as i}from"./p-19268c27.js";const l=new Map;async function f(n,o){var e;const a=s(i.env);const c=i.isShopToggleActive()&&o===t.shop;const l=u(a.CONTENT_URL,n);const f=c?p(a.SHOP_CONTENT_URL,n):Promise.resolve(null);const[h,d]=await Promise.allSettled([l,f]);if(h.status==="rejected"){throw h.reason}const w=r(n,o,h.value);const $=d.status==="fulfilled"?d.value:null;if($===null||w.shop===null){return w}return Object.assign(Object.assign({},w),{shop:Object.assign(Object.assign({},w.shop),{children:$.menuItems||((e=w.shop)===null||e===void 0?void 0:e.children)||[],additionalContent:$.additionalContent,availableLocales:w.shop.availableLocales,availableLocalesOnlyForShop:w.shop.availableLocalesOnlyForShop})})}async function u(o,t){const{country:s,language:r}=n(t);const i=e(o,t);const f=l.get(i);if(f!==undefined){return f}const u=await fetch(`${o}/${`${r}-${s}`}.json`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}});if(u.status===404){throw new a(`No content for locale ${t} found`,c.NO_RESULTS)}if(!u.ok){throw new a(`Could not get content for locale ${t}`,c.GENERAL)}const p=await u.json();l.set(i,p);return p}async function p(o,t){const{country:e,language:s}=n(t);const r=await fetch(`${o}/${e.toLowerCase()}/${`${s}-${e}`}/navigation`,{headers:{"Content-Type":"application/json","x-vercel-protection-bypass":"hXMkVgu6erfnX2ydOdeSCixWDWbPjBUk"}});if(r.status===404){throw new a(`No shop content for locale ${t} found`,c.NO_RESULTS)}if(!r.ok){throw new a(`Could not get shop content for locale ${t}`,c.GENERAL)}return r.json()}function h(t,e){const{country:a}=n(e);let c=a;if(c.includes("-")&&!o(c)){c=a.split("-")[0]}return`${t}/flags/${c}.svg`}async function d(n,o){try{const t=h(n,o);const e=await fetch(t);if(e.ok){return t}}catch(n){}return""}export{f,d as g};
//# sourceMappingURL=p-1dca3607.js.map