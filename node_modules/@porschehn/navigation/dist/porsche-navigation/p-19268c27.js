import{b as e,g as s}from"./p-b43baa04.js";import{V as t,N as a,a as n,w as o,i as r,b as l}from"./p-f7be0ef8.js";import{w as i}from"./p-f167c919.js";const h="featureOverrideEnabled";const c="porsche_75_years_logo";const d="shop";const f="pcom_search";const u="saved_items";const _="ab";const b="dealer_search_china";const p="opening_hours";const v={featureOverrideEnabled:{enabled:true},homenav_1723:{enabled:true},navi_3:{enabled:false},porsche_75_years_logo:{enabled:false},one_ui:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const m={featureOverrideEnabled:{enabled:true},homenav_1723:{enabled:true},navi_3:{enabled:false},porsche_75_years_logo:{enabled:false},one_ui:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const g={featureOverrideEnabled:{enabled:true},homenav_1723:{enabled:true},navi_3:{enabled:true},porsche_75_years_logo:{enabled:false},one_ui:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const w={featureOverrideEnabled:{enabled:false},homenav_1723:{enabled:false},navi_3:{enabled:true},porsche_75_years_logo:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const y={local:v,preview:m,test:g,production:w};const E="https://logs.nav.porsche.com";class O{constructor(){this.env=null;this.version=t;this.breakpoint=0;this.locale=null}init(e,s,t){this.env=e;this.breakpoint=s;this.locale=t}log(s,t,a,n,o){if(this.env===e.TEST){return}try{const r=JSON.stringify({name:s,level:t,env:this.env,breakpoint:this.breakpoint,locale:this.locale,version:this.version,hostname:i.location.hostname,pathname:i.location.pathname,id:a,errorType:o||"",message:n});if(this.env===e.PRODUCTION){if(t!=="debug"){fetch(E,{method:"POST",body:r,mode:"no-cors"})}}else{console[t](r)}}catch(e){}}info(e,s=""){this.log("PHN_HEADER_LOG_ENTRY","info",e,s)}error(e,s){const t=s instanceof a?s.type:n.GENERAL;this.log("PHN_HEADER_LOG_ENTRY","error",e,s.message,t)}}const T=new O;class N{constructor(e=s(o),t=y){this.featureEnvMap=t;this.features={};this.env="local";this.isShopToggleActive=()=>this.isFeatureEnabled(d,i.location.search);this.isPcomSearchToggleActive=()=>this.isFeatureEnabled(f,i.location.search);this.isSavedItemsToggleActive=()=>this.isFeatureEnabled(u,i.location.search);this.isABTestingToggleActive=()=>this.isFeatureEnabled(_,i.location.search);this.isDealerSearchChinaEnabled=()=>this.isFeatureEnabled(b,i.location.search);this.isDealerSearchOpeningHoursEnabled=()=>this.isFeatureEnabled(p,i.location.search);this.env=e;this.features=this.featureEnvMap[e]}async loadRemoteToggles(){try{const e=l(this.env).BFF_ENDPOINT;const s=await fetch(`${e}/toggles?env=${this.env}`);if(!s.ok){const e=await s.text();throw new Error(e)}const t=await s.json();this.features=t}catch(e){throw new a(`Load Feature Toggles failed with error: ${e}`,n.GENERAL)}}stringToBooleanStrict(e){if(e==="true"){return true}if(e==="false"){return false}return null}getUrlFeatureToggleOverride(e,s){var t,a;const n=(a=(t=s.split("?")[1])===null||t===void 0?void 0:t.split("&").find((s=>s.includes(e))))===null||a===void 0?void 0:a.split("=")[1];return r(n)?this.stringToBooleanStrict(n||""):null}getLocalStorageFeatureToggleOverride(e){const s=localStorage.getItem(`phn.${e}`);return r(s)?this.stringToBooleanStrict(s):null}isFeatureEnabled(s,t){var a;if(this.features===undefined){return false}if(this.env===e.PRODUCTION&&this.isOnSecurityLayer(s)){return false}if((a=this.features[h])===null||a===void 0?void 0:a.enabled){const e=[this.getUrlFeatureToggleOverride(s,t),this.getLocalStorageFeatureToggleOverride(s)];for(const s of e){if(s!==null){return s}}}if(this.features[s]!==undefined){return this.features[s].enabled}else{return false}}async setFeatures(e){this.env=e;try{if(e==="test"){this.features=this.featureEnvMap[e];return}await this.loadRemoteToggles()}catch(s){T.error("INIT_APP_CONFIG",s);this.features=this.featureEnvMap[e]}}isOnSecurityLayer(e){const s=["opening_hours"];return s.includes(e)}}const F=new N;export{c as F,F as f,T as l};
//# sourceMappingURL=p-19268c27.js.map