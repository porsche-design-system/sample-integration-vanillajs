{"version":3,"names":["getLevel1Items","content","dealerSearchResults","locale","loggedInState","unreadMessagesCount","userConsentGiven","dealer","models","myPorsche","vehiclePurchase","shop","experience","services","savedDealerCookie","ppnDealers","app","navStateStore","state","savedDealer","id","undefined","outboundLink","search","_a","link","dealerRoutingKeys","RoutingKeys","DEALER_SEARCH","_b","dealerSearchResultsStore","results","length","push","getDealerDetailsRoutingKey","ppnDealer","menu","elementId","MODELS","routingKeys","analyticsId","text","VEHICLE_PURCHASE","SERVICES","EXPERIENCE","dealerSearch","iconRight","shopItem","SHOP","Application","datalayerEventAction","EventActions","NAVIGATION_LINK_CLICK","splice","isDealerSearchEnabled","savedDealerName","splitLocale","language","name","isString","nameLocalized","subtext","map","onClick","isLoggedIn","IsLoggedIn","username","getUsername","loggedInFallback","MY_PORSCHE","showIconModifier","getSideDrawerItems","activeRoutingKey","topLevelRoutingKey","findTopLevelRoutingKey","series","modelsSeries","getModelsRoutingKey","tags","tag","join","renderSignatures","MODEL_RANGE_CLICK","parentRoutingKey","removeLastRoutingSegment","menuDrawerParent","getMenuContent","children","childItem","constructRoutingKey","getSideDrawerRoutingKey","getLastRoutingSegment","MAIN_MENU","routingKey","legacyMore","menuContent","MORE","experienceName","abTestingService","executeContentChange","idOfLastRoutingSegment","findMenuItemById","country","returnDealerSearch","isCountryInOneOfRegions","featureToggles","isDealerSearchChinaEnabled","getBackButtonText","previousRoutingKey","numberOfDealers","details","backToSearch","navContentStore","getHeadlineText","SERIES","routingId","find","getSubtext"],"sources":["src/services/menu-items-service.ts"],"sourcesContent":["import { Content, findMenuItemById, Series, TMenu, TShopMenu } from '../entities/content';\nimport { isCountryInOneOfRegions, splitLocale } from '../entities/locale';\nimport {\n  constructRoutingKey,\n  findTopLevelRoutingKey,\n  getDealerDetailsRoutingKey,\n  getLastRoutingSegment,\n  getModelsRoutingKey,\n  removeLastRoutingSegment,\n  RoutingKey,\n  RoutingKeys\n} from '../entities/routing-key';\nimport { DealerSearchResults, dealerSearchResultsStore } from '../state/dealer-search-results-store';\nimport { navContentStore } from '../state/nav-content-store';\nimport { navStateStore } from '../state/nav-state-store';\nimport { EventAction, EventActions } from '../utility/constants';\nimport { Application } from '../utility/constants/app';\nimport { getUsername, IsLoggedIn, isString } from '../utility/helper';\nimport featureToggles from './feature-toggles';\nimport abTestingService from './ab-testing/ab-testing-constructor-service';\n\nexport type MenuItemProps = {\n  elementId: string;\n  routingKeys: string[];\n  analyticsId: string;\n  text: string;\n  link?: string;\n  subtext?: string;\n  iconRight?: string;\n  showIconModifier?: boolean;\n  datalayerEventAction?: EventAction;\n  onClick?: () => void;\n};\n\nexport function getLevel1Items(\n  content: Content,\n  dealerSearchResults: DealerSearchResults,\n  locale: string,\n  loggedInState: string,\n  unreadMessagesCount: number,\n  userConsentGiven: boolean\n): MenuItemProps[] {\n  const { dealer, models, myPorsche, vehiclePurchase, shop, experience, services } = content;\n  const { savedDealerCookie, ppnDealers } = dealerSearchResults;\n  const { app } = navStateStore.state;\n  const savedDealer = savedDealerCookie !== null ? ppnDealers[savedDealerCookie.id] : undefined;\n\n  // outbound link needed for Singapore market\n  let outboundLink;\n  if (locale === 'en-SG' && dealer.search.outboundLink) {\n    outboundLink = dealer.search.outboundLink?.link;\n  }\n\n  const dealerRoutingKeys: string[] = [RoutingKeys.DEALER_SEARCH];\n\n  if (savedDealer !== undefined && dealerSearchResultsStore.state.results?.length != 1) {\n    dealerRoutingKeys.push(getDealerDetailsRoutingKey(savedDealer.ppnDealer.id));\n  }\n\n  const menu: MenuItemProps[] = [\n    {\n      elementId: RoutingKeys.MODELS,\n      routingKeys: [RoutingKeys.MODELS],\n      analyticsId: models.id,\n      text: models.text\n    },\n    {\n      elementId: RoutingKeys.VEHICLE_PURCHASE,\n      routingKeys: [RoutingKeys.VEHICLE_PURCHASE],\n      analyticsId: vehiclePurchase.id,\n      text: vehiclePurchase.text\n    },\n    {\n      elementId: RoutingKeys.SERVICES,\n      routingKeys: [RoutingKeys.SERVICES],\n      analyticsId: services.id,\n      text: services.text\n    },\n    {\n      elementId: RoutingKeys.EXPERIENCE,\n      routingKeys: [RoutingKeys.EXPERIENCE],\n      analyticsId: experience.id,\n      text: experience.text\n    }\n  ];\n\n  const dealerSearch: MenuItemProps = {\n    elementId: RoutingKeys.DEALER_SEARCH,\n    routingKeys: dealerRoutingKeys,\n    analyticsId: dealer.id,\n    text: dealer.text,\n    link: outboundLink,\n    iconRight: locale === 'en-SG' && dealer.search.outboundLink ? 'external' : 'arrow-head-right'\n  };\n\n  if (shop !== null && shop.text !== '') {\n    const shopItem: MenuItemProps = {\n      elementId: RoutingKeys.SHOP,\n      routingKeys: [RoutingKeys.SHOP],\n      analyticsId: shop.id,\n      text: shop.text,\n      link: app !== Application.shop ? shop.link : undefined,\n      datalayerEventAction: EventActions.NAVIGATION_LINK_CLICK,\n      iconRight: 'external'\n    };\n\n    menu.splice(2, 0, shopItem);\n  }\n\n  if (isDealerSearchEnabled(locale, userConsentGiven)) {\n    const savedDealerName =\n      splitLocale(locale).language === 'en'\n        ? savedDealer?.ppnDealer.name\n        : isString(savedDealer?.ppnDealer.nameLocalized)\n        ? savedDealer?.ppnDealer.nameLocalized\n        : savedDealer?.ppnDealer.name;\n\n    if (isString(savedDealerName)) {\n      dealerSearch.subtext = savedDealerName;\n    }\n  } else {\n    dealerSearch.link = dealer.search.map.link;\n    dealerSearch.onClick = undefined;\n  }\n\n  menu.push(dealerSearch);\n\n  if (myPorsche !== null) {\n    const isLoggedIn = IsLoggedIn(loggedInState);\n    const username = isLoggedIn ? getUsername(loggedInState, myPorsche.loggedInFallback) : undefined;\n\n    menu.push({\n      elementId: RoutingKeys.MY_PORSCHE,\n      routingKeys: [RoutingKeys.MY_PORSCHE],\n      analyticsId: myPorsche.id,\n      text: myPorsche.text,\n      subtext: username,\n      showIconModifier: isLoggedIn && unreadMessagesCount > 0\n    });\n  }\n\n  return menu;\n}\n\nexport function getSideDrawerItems(\n  content: Content,\n  dealerSearchResults: DealerSearchResults,\n  locale: string,\n  loggedInState: string,\n  unreadMessagesCount: number,\n  activeRoutingKey: string,\n  userConsentGiven: boolean\n): MenuItemProps[] {\n  const topLevelRoutingKey = findTopLevelRoutingKey(activeRoutingKey);\n\n  switch (topLevelRoutingKey) {\n    case activeRoutingKey:\n      break;\n\n    case RoutingKeys.MODELS:\n      return content.models.series.map((modelsSeries) => ({\n        elementId: getModelsRoutingKey(modelsSeries.id),\n        routingKeys: [getModelsRoutingKey(modelsSeries.id)],\n        analyticsId: modelsSeries.id,\n        text: modelsSeries.name,\n        subtext: modelsSeries.tags.map((tag) => tag.text).join(' | '),\n        renderSignatures: true,\n        datalayerEventAction: EventActions.MODEL_RANGE_CLICK\n      }));\n\n    case RoutingKeys.SHOP:\n    case RoutingKeys.VEHICLE_PURCHASE:\n    case RoutingKeys.SERVICES:\n    case RoutingKeys.EXPERIENCE: {\n      const parentRoutingKey = removeLastRoutingSegment(activeRoutingKey);\n      const menuDrawerParent = getMenuContent(content, parentRoutingKey, topLevelRoutingKey);\n\n      if (menuDrawerParent !== null) {\n        return menuDrawerParent.children.map((childItem) => ({\n          elementId: constructRoutingKey(parentRoutingKey, childItem.id),\n          routingKeys: [constructRoutingKey(parentRoutingKey, childItem.id)],\n          analyticsId: childItem.id,\n          text: childItem.text,\n          link: childItem.link\n        }));\n      }\n\n      break;\n    }\n  }\n\n  return getLevel1Items(content, dealerSearchResults, locale, loggedInState, unreadMessagesCount, userConsentGiven);\n}\n\nexport function getSideDrawerRoutingKey(activeRoutingKey: string): string {\n  const topLevelRoutingKey = findTopLevelRoutingKey(activeRoutingKey);\n\n  switch (topLevelRoutingKey) {\n    case activeRoutingKey: {\n      break;\n    }\n\n    case RoutingKeys.DEALER_SEARCH: {\n      return RoutingKeys.DEALER_SEARCH;\n    }\n\n    case RoutingKeys.MODELS: {\n      return RoutingKeys.MODELS;\n    }\n\n    case RoutingKeys.SHOP:\n    case RoutingKeys.VEHICLE_PURCHASE:\n    case RoutingKeys.SERVICES:\n    case RoutingKeys.EXPERIENCE: {\n      const parentRoutingKey = removeLastRoutingSegment(activeRoutingKey);\n      return getLastRoutingSegment(parentRoutingKey);\n    }\n  }\n  return RoutingKeys.MAIN_MENU;\n}\n\nexport function getMenuContent(\n  content: Content,\n  routingKey: string,\n  topLevelRoutingKey: string\n): TMenu | TShopMenu | null {\n  const { vehiclePurchase, experience, shop, legacyMore, services } = content;\n\n  const menuContent: TMenu | undefined | null = {\n    [RoutingKeys.VEHICLE_PURCHASE]: vehiclePurchase,\n    [RoutingKeys.EXPERIENCE]: experience,\n    [RoutingKeys.SHOP]: shop,\n    [RoutingKeys.MORE]: legacyMore,\n    [RoutingKeys.SERVICES]: services\n  }[topLevelRoutingKey];\n\n  if (menuContent === undefined || menuContent === null) {\n    return null;\n  }\n  if (isString(menuContent.experienceName)) {\n    menuContent.children = abTestingService().executeContentChange(menuContent);\n  }\n\n  const idOfLastRoutingSegment: string = getLastRoutingSegment(routingKey);\n  return idOfLastRoutingSegment === topLevelRoutingKey\n    ? menuContent\n    : findMenuItemById(menuContent, idOfLastRoutingSegment);\n}\n\nexport function isDealerSearchEnabled(locale: string, userConsentGiven: boolean): boolean {\n  try {\n    const { country } = splitLocale(locale);\n    const returnDealerSearch = !isCountryInOneOfRegions(country) && userConsentGiven;\n\n    return (featureToggles.isDealerSearchChinaEnabled() || country !== 'CN') && returnDealerSearch;\n  } catch {\n    // ignore error\n  }\n  return true;\n}\n\nexport function getBackButtonText(content: Content, previousRoutingKey: string): string {\n  if (!isString(previousRoutingKey)) {\n    return '';\n  }\n\n  const topLevelRoutingKey = findTopLevelRoutingKey(previousRoutingKey);\n\n  switch (topLevelRoutingKey) {\n    case RoutingKeys.MODELS: {\n      return content.models.text;\n    }\n\n    case RoutingKeys.DEALER_SEARCH:\n      if (content.dealer.numberOfDealers === 1) {\n        return '';\n      }\n      return content.dealer.details.backToSearch;\n\n    case RoutingKeys.SHOP:\n    case RoutingKeys.VEHICLE_PURCHASE:\n    case RoutingKeys.MORE:\n    case RoutingKeys.EXPERIENCE: {\n      const menuContent = getMenuContent(navContentStore.state, previousRoutingKey, topLevelRoutingKey);\n\n      if (menuContent !== null) {\n        return menuContent.text;\n      }\n\n      break;\n    }\n  }\n\n  return '';\n}\n\nexport function getHeadlineText(content: Content, routingKey: string, topLevelRoutingKey: string): string {\n  const { dealer, myPorsche, models, vehiclePurchase, experience, shop, legacyMore, services } = content;\n  let menuContent: TMenu | undefined | null | Series;\n  switch (topLevelRoutingKey) {\n    case RoutingKeys.MORE:\n    case RoutingKeys.SHOP:\n    case RoutingKeys.EXPERIENCE:\n    case RoutingKeys.SERVICES:\n    case RoutingKeys.VEHICLE_PURCHASE: {\n      menuContent = {\n        [RoutingKeys.VEHICLE_PURCHASE]: vehiclePurchase,\n        [RoutingKeys.EXPERIENCE]: experience,\n        [RoutingKeys.SHOP]: shop,\n        [RoutingKeys.MORE]: legacyMore,\n        [RoutingKeys.SERVICES]: services\n      }[topLevelRoutingKey];\n\n      if (menuContent === undefined) {\n        return '';\n      }\n\n      const idOfLastRoutingSegment: string = getLastRoutingSegment(routingKey);\n      return idOfLastRoutingSegment === topLevelRoutingKey\n        ? (menuContent?.text as string)\n        : (findMenuItemById(menuContent, idOfLastRoutingSegment)?.text as string);\n    }\n    case RoutingKeys.SERIES:\n    case RoutingKeys.MODELS: {\n      const routingId = getLastRoutingSegment(routingKey);\n      menuContent = models.series.find((modelsSeries) => routingId === modelsSeries.id);\n\n      return menuContent === undefined ? models.text : menuContent?.id;\n    }\n    case RoutingKeys.DEALER_SEARCH: {\n      return dealer.search.text;\n    }\n    case RoutingKeys.MY_PORSCHE: {\n      return myPorsche?.text as string;\n    }\n  }\n  return '';\n}\n\nexport function getSubtext(\n  topLevelRoutingKey?: RoutingKey,\n  activeRoutingKey?: string,\n  locale?: string\n): string | undefined {\n  const { myPorsche, models } = navContentStore.state;\n  const { loggedInState } = navStateStore.state;\n\n  if (topLevelRoutingKey === RoutingKeys.MY_PORSCHE) {\n    const isLoggedIn = IsLoggedIn(loggedInState);\n    return isLoggedIn ? getUsername(loggedInState, myPorsche?.loggedInFallback || '') : '';\n  }\n\n  if (topLevelRoutingKey === RoutingKeys.DEALER_SEARCH) {\n    const { savedDealerCookie, ppnDealers } = dealerSearchResultsStore.state;\n    const savedDealer = savedDealerCookie !== null ? ppnDealers[savedDealerCookie.id] : undefined;\n    const savedDealerName =\n      locale && splitLocale(locale).language === 'en'\n        ? savedDealer?.ppnDealer.name\n        : isString(savedDealer?.ppnDealer.nameLocalized)\n        ? savedDealer?.ppnDealer.nameLocalized\n        : savedDealer?.ppnDealer.name;\n\n    return savedDealerCookie ? savedDealerName : '';\n  }\n\n  if (topLevelRoutingKey === RoutingKeys.MODELS) {\n    if (isString(activeRoutingKey)) {\n      const routingId = getLastRoutingSegment(activeRoutingKey);\n      const menuContent = models.series.find((modelsSeries) => routingId === modelsSeries.id);\n      if (menuContent) {\n        return menuContent.tags.map((tag) => tag.text).join(' | ');\n      }\n    }\n  }\n\n  return '';\n}\n"],"mappings":"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"}