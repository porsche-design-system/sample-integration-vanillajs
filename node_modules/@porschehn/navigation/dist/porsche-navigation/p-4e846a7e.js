import{s as n,N as o,a as t,i as e}from"./p-ce02e561.js";import{A as a,w as c,a as s}from"./p-e1568a59.js";import{m as r}from"./p-b6eee943.js";import{f as i}from"./p-f9052552.js";const l=new Map;async function f(n,o){var t;const e=s(i.env);const c=i.isShopToggleActive()&&o===a.shop;const l=u(e.CONTENT_URL,n);const f=c?p(e.SHOP_CONTENT_URL,n):Promise.resolve(null);const[h,d]=await Promise.allSettled([l,f]);if(h.status==="rejected"){throw h.reason}const w=r(n,o,h.value);const $=d.status==="fulfilled"?d.value:null;if($===null||w.shop===null){return w}return Object.assign(Object.assign({},w),{shop:Object.assign(Object.assign({},w.shop),{children:$.menuItems||((t=w.shop)===null||t===void 0?void 0:t.children)||[],additionalContent:$.additionalContent,availableLocales:w.shop.availableLocales,availableLocalesOnlyForShop:w.shop.availableLocalesOnlyForShop})})}async function u(e,a){const{country:s,language:r}=n(a);const i=c(e,a);const f=l.get(i);if(f!==undefined){return f}const u=await fetch(`${e}/${`${r}-${s}`}.json`,{headers:{"Cache-Control":"no-cache","Content-Type":"application/json"}});if(u.status===404){throw new o(`No content for locale ${a} found`,t.NO_RESULTS)}if(!u.ok){throw new o(`Could not get content for locale ${a}`,t.GENERAL)}const p=await u.json();l.set(i,p);return p}async function p(e,a){const{country:c,language:s}=n(a);const r=await fetch(`${e}/${c.toLowerCase()}/${`${s}-${c}`}/navigation`,{headers:{"Content-Type":"application/json","x-vercel-protection-bypass":"hXMkVgu6erfnX2ydOdeSCixWDWbPjBUk"}});if(r.status===404){throw new o(`No shop content for locale ${a} found`,t.NO_RESULTS)}if(!r.ok){throw new o(`Could not get shop content for locale ${a}`,t.GENERAL)}return r.json()}function h(o,t){const{country:a}=n(t);let c=a;if(c.includes("-")&&!e(c)){c=a.split("-")[0]}return`${o}/flags/${c}.svg`}async function d(n,o){try{const t=h(n,o);const e=await fetch(t);if(e.ok){return t}}catch(n){}return""}export{f,d as g};
//# sourceMappingURL=p-4e846a7e.js.map