import{N as e,a as t,c as n,n as o,g as s}from"./p-a3dbf459.js";import{o as r,t as i,g as a,C as l,M as d,v as c,w as u,i as w,r as h,V as f,u as v,a as g}from"./p-d06201e6.js";const m="featureOverrideEnabled";const p="porsche_75_years_logo";const _="shop";const b="pcom_search";const y="saved_items";const O="ab";const E="dealer_search_china";const A="opening_hours";const S="sentry";const N={featureOverrideEnabled:{enabled:true},homenav_1723:{enabled:true},navi_3:{enabled:false},porsche_75_years_logo:{enabled:false},one_ui:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const k={featureOverrideEnabled:{enabled:true},homenav_1723:{enabled:true},navi_3:{enabled:false},porsche_75_years_logo:{enabled:false},one_ui:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const $={featureOverrideEnabled:{enabled:true},homenav_1723:{enabled:true},navi_3:{enabled:true},porsche_75_years_logo:{enabled:false},one_ui:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const T={featureOverrideEnabled:{enabled:false},homenav_1723:{enabled:false},navi_3:{enabled:true},porsche_75_years_logo:{enabled:false},mock_shop_content:{enabled:false},shop:{enabled:false},pcom_search:{enabled:false}};const F={local:N,preview:k,test:$,production:T};class H{constructor(){this.initialBodyStyleValues={top:"",position:"",inlineSize:"",overflowY:""};this.initialDocumentScrollTop=0}get location(){return window.location}set location(e){window.location=e}get sessionStorage(){return window.sessionStorage}get localStorage(){return window.localStorage}set version(e){Object.assign(window,{PHN_HEADER_VERSION:e})}set navigationLoaded(e){Object.assign(window,{PHN_NAVIGATION_LOADED:e})}get bodyOverflow(){return document.body.style.overflow}get bodyHeight(){return document.body.style.height}requestAnimationFrame(e){return window.requestAnimationFrame(e)}createDiv(){return window.document.createElement("div")}getBreakpoint(){const e=Math.max(window.document.documentElement.clientWidth,window.innerWidth||0);const t=Object.keys(r).reverse().find((t=>i(r,t)&&e>=r[t]));return typeof t==="string"&&i(r,t)?r[t]:0}get redirected(){return window.REDIRECTED===true||window.location.search.includes("cs_redirect=")}createIframe(e,t){const n=window.document.createElement("iframe");n.id=e;n.style.display="none";n.src=t;window.document.body.appendChild(n)}removeElement(e){var t;(t=window.document.getElementById(e))===null||t===void 0?void 0:t.remove()}redirectToUrl(e){window.location.assign(e)}generateRandom(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";const n=new Uint8Array(e);window.crypto.getRandomValues(n);const o=[];for(let e=0;e<n.byteLength;e+=1){const s=n[e]%t.length;o.push(t[s])}return o.join("")}maybeCheckMarketingConsent(e){var t,n,o,s,r,i,a,l,d,c,u;const w={processorId:(o=(n=(t=window.GlobalConsent)===null||t===void 0?void 0:t.Processor)===null||n===void 0?void 0:n.googleMaps)!==null&&o!==void 0?o:"Google Maps",timeoutVar:{},mapContainer:"",callbacks:{success:e}};if(typeof((r=(s=window.PCOM)===null||s===void 0?void 0:s.globalConsent)===null||r===void 0?void 0:r.checkConsent)==="function"){(l=(a=(i=window.PCOM)===null||i===void 0?void 0:i.globalConsent)===null||a===void 0?void 0:a.checkConsent)===null||l===void 0?void 0:l.call(a,w);return true}if(typeof((d=window.ucPrivacyShield)===null||d===void 0?void 0:d.checkConsent)==="function"){(u=(c=window.ucPrivacyShield)===null||c===void 0?void 0:c.checkConsent)===null||u===void 0?void 0:u.call(c,w);return true}e();return false}async deriveChallenge(n){if(n.length<43||n.length>128){throw new e("invalid code length",t.INVALID_INPUT)}const o=new ArrayBuffer(n.length);const s=new Uint8Array(o);for(let e=0;e<n.length;e++){s[e]=n.charCodeAt(e)}const r=await window.crypto.subtle.digest("SHA-256",s);const i=new Uint8Array(r);let a="";for(let e=0;e<i.byteLength;e++){a+=String.fromCharCode(i[e])}return window.btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}async hashString(e){const t=(new TextEncoder).encode(e);const n=await window.crypto.subtle.digest("SHA-256",t);const o=Array.from(new Uint8Array(n));return o.map((e=>e.toString(16).padStart(2,"0"))).join("")}getScrollbarWidth(){const e=window.document.createElement("div");e.style.overflow="scroll";window.document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;window.document.body.removeChild(e);return Number.isNaN(t)?"0px":`${t}px`}async fetchGoogleMapsApi(n,o=`https://maps.googleapis.com/maps/api/js?key=${n}&libraries=places`){if(window.google!==undefined&&window.google.maps!==undefined&&window.google.maps.version!==undefined){return window.google}const s=document.getElementById("googleMaps");if(s){return window.google}const r=document.createElement("script");r.src=o;r.id="googleMaps";document.head.appendChild(r);return new Promise(((n,o)=>{r.onerror=()=>{o(new e("Failed to load google maps script.",t.GENERAL))};r.onload=()=>{n(window.google)}}))}async getNavigatorLatLong(){return new Promise(((t,n)=>{window.navigator.geolocation.getCurrentPosition((({coords:{latitude:e,longitude:n}})=>{t({latitude:e,longitude:n})}),(t=>n(new e(`geolocation.getCurrentPosition failed with ${t.code}: ${t.message}`,L(t)))))}))}getCookie(e){var t;return a((t=document.cookie.split("; ").find((t=>t.startsWith(`${e}=`))))===null||t===void 0?void 0:t.split("=")[1])}setCookie(e,t){document.cookie=`${e}=${t};domain=${l};expires=${new Date(Date.now()+d*10).toUTCString()};`}btoa(e){return window.btoa(e)}lockScroll(){this.initialBodyStyleValues=c(document.body.style,this.initialBodyStyleValues);this.initialDocumentScrollTop=document.documentElement.scrollTop;document.body.style.top=`-${document.documentElement.scrollTop}px`;document.body.style.position="fixed";document.body.style.inlineSize="100%";document.body.style.overflowY="scroll"}unlockScroll(){Object.entries(this.initialBodyStyleValues).forEach((([e,t])=>document.body.style.setProperty(u(e),t)));document.documentElement.scrollTop=this.initialDocumentScrollTop}hasScrollbar(){return window.document.body.offsetHeight>window.innerHeight}async waitForElement(e,t){if(!w(t)){return e}const n=h(e.querySelector(t));if(n!==null){return n}return new Promise((n=>{const o=new MutationObserver((()=>{const s=h(e.querySelector(t));if(s!==null){n(s);o.disconnect()}}));o.observe(e,{childList:true,subtree:true})}))}}function L(e){switch(e.code){case e.PERMISSION_DENIED:{return t.GEOLOCATION_DENIED}case e.POSITION_UNAVAILABLE:case e.TIMEOUT:{return t.RETRY}default:{return t.GENERAL}}}const P=new H;class C{constructor(){this.version=f;this.breakpoint=0;this.locale=null}init(e,t){this.breakpoint=P.getBreakpoint();this.locale=t}log(e,t,s,r,i){const{env:a}=o.state;if(a===n.TEST){return}try{const o=JSON.stringify({name:e,level:t,env:a,breakpoint:this.breakpoint,locale:this.locale,version:this.version,hostname:P.location.hostname,pathname:P.location.pathname,id:s,errorType:i||"",message:r});if(a!==n.PRODUCTION){console[t](o)}}catch(e){}}info(e,t=""){this.log("PHN_HEADER_LOG_ENTRY","info",e,t)}error(n,o){const s=o instanceof e?o.type:t.GENERAL;this.log("PHN_HEADER_LOG_ENTRY","error",n,o.message,s)}}const D=new C;class I{constructor(e=s(v),t=F){this.featureEnvMap=t;this.features={};this.env="local";this.isShopToggleActive=()=>this.isFeatureEnabled(_,P.location.search);this.isPcomSearchToggleActive=()=>this.isFeatureEnabled(b,P.location.search);this.isSavedItemsToggleActive=()=>this.isFeatureEnabled(y,P.location.search);this.isABTestingToggleActive=()=>this.isFeatureEnabled(O,P.location.search);this.isDealerSearchChinaEnabled=()=>this.isFeatureEnabled(E,P.location.search);this.isDealerSearchOpeningHoursEnabled=()=>this.isFeatureEnabled(A,P.location.search);this.isSentryEnabled=()=>this.isFeatureEnabled(S,P.location.search);this.env=e;this.features=this.featureEnvMap[e]}async loadRemoteToggles(){try{const e=g(this.env).BFF_ENDPOINT;const t=await fetch(`${e}/toggles?env=${this.env}`);if(!t.ok){const e=await t.text();throw new Error(e)}const n=await t.json();this.features=n}catch(n){throw new e(`Load Feature Toggles failed with error: ${n}`,t.GENERAL)}}stringToBooleanStrict(e){if(e==="true"){return true}if(e==="false"){return false}return null}getUrlFeatureToggleOverride(e,t){var n,o;const s=(o=(n=t.split("?")[1])===null||n===void 0?void 0:n.split("&").find((t=>t.includes(e))))===null||o===void 0?void 0:o.split("=")[1];return w(s)?this.stringToBooleanStrict(s||""):null}getLocalStorageFeatureToggleOverride(e){const t=localStorage.getItem(`phn.${e}`);return w(t)?this.stringToBooleanStrict(t):null}isFeatureEnabled(e,t){var o;if(this.features===undefined){return false}if(this.env===n.PRODUCTION&&this.isOnSecurityLayer(e)){return false}if((o=this.features[m])===null||o===void 0?void 0:o.enabled){const n=[this.getUrlFeatureToggleOverride(e,t),this.getLocalStorageFeatureToggleOverride(e)];for(const e of n){if(e!==null){return e}}}if(this.features[e]!==undefined){return this.features[e].enabled}else{return false}}async setFeatures(e){this.env=e;try{if(e==="test"){this.features=this.featureEnvMap[e];return}await this.loadRemoteToggles()}catch(t){D.error("INIT_APP_CONFIG",t);this.features=this.featureEnvMap[e]}}isOnSecurityLayer(e){const t=[S,A];return t.includes(e)}}const M=new I;export{p as F,M as f,D as l,P as w};
//# sourceMappingURL=p-0e57ad49.js.map