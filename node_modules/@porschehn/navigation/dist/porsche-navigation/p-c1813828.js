import{q as n,r as e}from"./p-d06201e6.js";const t={};const i={};let o=null;const r=1e3;function s(n){o=n;o.addEventListener("transitionend",d);o.addEventListener("animationend",d)}function c(n,e){i[n]=e}function a(){Object.keys(i).forEach((n=>delete i[n]))}async function f(n){const e=i[n];if(e===undefined){return new Promise(((e,t)=>t(new Error(`Sequence ${n} has not been registered`))))}if(!e.running){e.promise=new Promise(((n,t)=>{e.resolve=()=>{e.running=false;n()};e.reject=n=>{e.running=false;t(n)};e.running=true;u(e)}))}return e.promise}async function u(n){var e;if(n.currentStepIndex>=n.steps.length){l(n);return}const t=n.steps[n.currentStepIndex];const i=[];for(const n of t){i.push(m(n))}try{await Promise.all(i)}catch(t){(e=n.reject)===null||e===void 0?void 0:e.call(n,t);return}n.currentStepIndex+=1;setTimeout((()=>u(n)),0)}function l(n){var e;n.currentStepIndex=0;(e=n.resolve)===null||e===void 0?void 0:e.call(n,null);n.promise=undefined}function d(n){const t=e(n.target);if(t===null){throw new Error(`${n.type} event target is null`)}const i=t.dataset.phnAmId;if(i!==undefined&&i!==null){p(i,t)}}async function m({onStart:e,onEnd:t,animation:i,elementSelector:r}){if(o===null){throw new Error("No root element present")}if(e){const t=e();if(n(t)){await t}}const s=Array.from(o.querySelectorAll(r));const c=[];for(const n of s){const e=w(h)(n,i);c.push(e)}await Promise.all(c);if(t){const e=t();if(n(e)){await e}}}function w(e){return async function(t,i){const{cleanUpBeforeAnimation:o,cleanUpAfterAnimation:r}=i;const s=e(t,i);if(typeof o==="function"){const e=o(t);if(n(e)){await e}}await s;if(typeof r==="function"){const e=r(t);if(n(e)){await e}}if(r!==false){t.classList.remove(i.className)}}}const h=(n,e)=>{const i=Math.floor(Math.random()*1e7);n.classList.add(e.className);n.dataset.phnAmId=i.toString();let o;let s;let c;const a=new Promise(((t,a)=>{o=t;s=a;c=setTimeout((()=>{console.warn(`Animation with className ${e.className} didn't finish after ${r}ms. Forcefully finishing animation and continuing with the rest of the sequence.`);p(String(i),n)}),r)}));t[i]={animation:e,resolve:o,reject:s,promise:a,timeout:c};return a};function p(n,e){const{resolve:i,timeout:o}=t[n];clearTimeout(o);delete t[n];delete e.dataset.phnAmId;i()}function y(n){const e=i[n];if(e===undefined){throw new Error(`Sequence ${n} has not been registered`)}return e.promise!==undefined}function g(n,e){return{steps:n.map((n=>n.map((n=>Object.assign(Object.assign({},e),n))))),currentStepIndex:0,running:false}}const v={initialize:s,play:f,isPlaying:y,register:c,reset:a};export{v as a,g as m};
//# sourceMappingURL=p-c1813828.js.map