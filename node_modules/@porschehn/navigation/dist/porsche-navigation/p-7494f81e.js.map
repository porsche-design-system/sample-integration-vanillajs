{"version":3,"names":["handleAnimationRouting","actions","OPENING","openingAction","CLOSING","closingAction","FORWARD","forwardAction","BACKWARDS","backwardAction","UNCHANGED","unchangedAction","conditionToExecute","getSingleDrawerAction","isOpening","isClosing","isAnimatingForward","isAnimatingBackward","animationManager","play","AnimationSequences","OPEN_SINGLE_DRAWER","nextRoute","currentRoute","getCurrentRoute","CLOSE_SINGLE_DRAWER","then","getAnimatedRoute","setTimeout","TRANSITION_NEXT_LEVEL_SINGLE_DRAWER","_a","_b","TRANSITION_PREVIOUS_LEVEL_SINGLE_DRAWER","isPlayingSingleDrawerAnimation","singleDrawerAnimationSequences","some","sequence","isPlaying","e","routingKeyHistory","routingKeyPointer","routerStore","state","animatingPointer","goTo","routes","newHistory","RoutingKeys","MAIN_MENU","length","back","findTopLevelRoutingKey","DEALER_SEARCH","dealerSearchResultsStore","savedDealerCookie","pop","isNavigatingBackwards","addRoute","newRoute","isDesktop","windowService","getBreakpoint","dispatchEvent","bubbles","cancelable","detail","constructRoutingKey","reset","RoutingKeyPointers","LEVEL_ZERO","isOpened","isClosed","syncAnimation","showBackButton","section","sectionKey","indexOf","LEVEL_TWO"],"sources":["src/components/single-drawer/animations/animations-controller.ts","src/services/routing-manager.ts"],"sourcesContent":["import animationManager from '../../../services/animations/animation-manager';\nimport { AnimationSequences, AnimationSequencesType } from '../../../utility/constants';\nimport {\n  getAnimatedRoute,\n  getCurrentRoute,\n  isAnimatingBackward,\n  isAnimatingForward,\n  isClosing,\n  isOpening\n} from '../../../services/routing-manager';\n\nexport const handleAnimationRouting = (): AnimationRouting => {\n  const actions: Record<Operations, () => AnimationRouting> = {\n    OPENING: openingAction,\n    CLOSING: closingAction,\n    FORWARD: forwardAction,\n    BACKWARDS: backwardAction,\n    UNCHANGED: unchangedAction\n  };\n\n  const conditionToExecute = getSingleDrawerAction();\n\n  return actions[conditionToExecute]();\n};\n\ntype Operations = 'OPENING' | 'CLOSING' | 'FORWARD' | 'BACKWARDS' | 'UNCHANGED';\nfunction getSingleDrawerAction(): Operations {\n  if (isOpening()) {\n    return 'OPENING';\n  }\n  if (isClosing()) {\n    return 'CLOSING';\n  }\n  if (isAnimatingForward()) {\n    return 'FORWARD';\n  }\n  if (isAnimatingBackward()) {\n    return 'BACKWARDS';\n  }\n  return 'UNCHANGED';\n}\n\ntype AnimationRouting = { nextRoute: string; currentRoute: string };\n\nconst openingAction = (): AnimationRouting => {\n  animationManager.play(AnimationSequences.OPEN_SINGLE_DRAWER);\n\n  return {\n    nextRoute: '',\n    currentRoute: getCurrentRoute()\n  };\n};\n\nconst closingAction = (): AnimationRouting => {\n  animationManager.play(AnimationSequences.CLOSE_SINGLE_DRAWER).then(() => {\n    // TODO: Focus on burger button if using the keyboard\n  });\n\n  return {\n    nextRoute: getCurrentRoute() || '',\n    currentRoute: getAnimatedRoute() || ''\n  };\n};\n\nconst forwardAction = (): AnimationRouting => {\n  setTimeout(() => {\n    animationManager.play(AnimationSequences.TRANSITION_NEXT_LEVEL_SINGLE_DRAWER);\n  });\n\n  return {\n    nextRoute: getCurrentRoute() ?? '',\n    currentRoute: getAnimatedRoute() ?? ''\n  };\n};\n\nconst backwardAction = (): AnimationRouting => {\n  if (getCurrentRoute() !== '') {\n    setTimeout(() => {\n      animationManager.play(AnimationSequences.TRANSITION_PREVIOUS_LEVEL_SINGLE_DRAWER);\n    });\n  }\n\n  return {\n    nextRoute: getAnimatedRoute() ?? '',\n    currentRoute: getCurrentRoute() ?? ''\n  };\n};\n\nconst unchangedAction = (): AnimationRouting => {\n  return {\n    nextRoute: '',\n    currentRoute: getCurrentRoute()\n  };\n};\n\nexport const isPlayingSingleDrawerAnimation = (): boolean => {\n  try {\n    const singleDrawerAnimationSequences: AnimationSequencesType[] = [\n      AnimationSequences.OPEN_SINGLE_DRAWER,\n      AnimationSequences.CLOSE_SINGLE_DRAWER,\n      AnimationSequences.TRANSITION_NEXT_LEVEL_SINGLE_DRAWER,\n      AnimationSequences.TRANSITION_PREVIOUS_LEVEL_SINGLE_DRAWER\n    ];\n\n    return singleDrawerAnimationSequences.some((sequence) => {\n      try {\n        return animationManager.isPlaying(sequence);\n      } catch {\n        return false;\n      }\n    });\n  } catch (e) {\n    return false;\n  }\n};\n","import { routerStore } from '../state/router-store';\nimport { constructRoutingKey, findTopLevelRoutingKey, RoutingKeyPointers, RoutingKeys } from '../entities/routing-key';\nimport { dispatchEvent, isDesktop } from '../utility/helper';\nimport windowService from './window-service';\nimport { dealerSearchResultsStore } from '../state/dealer-search-results-store';\nimport { isPlayingSingleDrawerAnimation } from '../components/single-drawer/animations/animations-controller';\n\nexport const getCurrentRoute = (): string => {\n  const { routingKeyHistory, routingKeyPointer } = routerStore.state;\n  return routingKeyHistory[routingKeyPointer] || '';\n};\n\nexport const getAnimatedRoute = (): string => {\n  const { routingKeyHistory, animatingPointer } = routerStore.state;\n  return routingKeyHistory[animatingPointer] || '';\n};\n\nexport const goTo = (...routes: string[]): void => {\n  const newHistory = [RoutingKeys.MAIN_MENU, ...routes];\n  routerStore.state.routingKeyPointer = routes.length;\n  routerStore.state.routingKeyHistory = newHistory;\n};\n\nexport const back = (): void => {\n  if (!isPlayingSingleDrawerAnimation()) {\n    if (findTopLevelRoutingKey(getCurrentRoute()) === RoutingKeys.DEALER_SEARCH) {\n      dealerSearchResultsStore.state.savedDealerCookie = null;\n    }\n    routerStore.state.routingKeyPointer = routerStore.state.routingKeyPointer - 1;\n  }\n};\n\nexport const pop = (): void => {\n  if (isNavigatingBackwards()) routerStore.state.routingKeyHistory.pop();\n};\n\nexport const addRoute = (newRoute: string[]): void => {\n  if (isDesktop(windowService.getBreakpoint())) {\n    dispatchEvent('phn-router', 'mobileMenuItemClick', {\n      bubbles: true,\n      cancelable: false,\n      detail: [constructRoutingKey(getCurrentRoute(), ...newRoute)]\n    });\n  } else {\n    const newHistory = [...routerStore.state.routingKeyHistory, constructRoutingKey(getCurrentRoute(), ...newRoute)];\n    routerStore.state.routingKeyPointer = newHistory.length - 1;\n    routerStore.state.routingKeyHistory = newHistory;\n  }\n};\n\nexport const reset = (): void => {\n  routerStore.state.routingKeyPointer = -1;\n};\n\nexport const isNavigatingBackwards = (): boolean => {\n  return routerStore.state.routingKeyPointer < routerStore.state.routingKeyHistory.length - 1;\n};\n\nexport const isAnimating = (): boolean => {\n  const { routingKeyPointer, animatingPointer } = routerStore.state;\n  return routingKeyPointer !== animatingPointer;\n};\n\n//____________ANIMATIONS______________//\n\nexport const isAnimatingForward = (): boolean => {\n  return routerStore.state.routingKeyPointer > routerStore.state.animatingPointer;\n};\n\nexport const isAnimatingBackward = (): boolean => {\n  return routerStore.state.routingKeyPointer < routerStore.state.animatingPointer;\n};\n\nexport const isOpening = (): boolean => {\n  return (\n    routerStore.state.animatingPointer === RoutingKeyPointers.LEVEL_ZERO && routerStore.state.routingKeyPointer >= 0\n  );\n};\n\nexport const isOpened = (): boolean => {\n  return !isClosed();\n};\n\nexport const isClosed = (): boolean => {\n  return (\n    routerStore.state.routingKeyPointer === RoutingKeyPointers.LEVEL_ZERO &&\n    routerStore.state.animatingPointer === RoutingKeyPointers.LEVEL_ZERO\n  );\n};\nexport const isClosing = (): boolean => {\n  return routerStore.state.routingKeyPointer === -1 && routerStore.state.animatingPointer >= 0;\n};\n\nexport const syncAnimation = () => {\n  routerStore.state.animatingPointer = routerStore.state.routingKeyPointer;\n};\n\nexport const showBackButton = (section: string): boolean => {\n  const sectionKey = routerStore.state.routingKeyHistory.indexOf(section);\n\n  return sectionKey >= RoutingKeyPointers.LEVEL_TWO;\n};\n"],"mappings":"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"}