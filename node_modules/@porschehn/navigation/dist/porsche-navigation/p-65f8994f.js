import{e as t,N as e,a as n,b as s,n as o}from"./p-a3dbf459.js";import{w as i,f as r,l as a}from"./p-0e57ad49.js";import{S as c,r as u}from"./p-d06201e6.js";const m=t({searchTerm:"",results:null,savedDealerCookie:h(),ppnDealers:{},dealersOfRegion:{regions:[]}});m.onChange("savedDealerCookie",(t=>{i.setCookie(c,JSON.stringify(t))}));function h(){try{return JSON.parse(i.getCookie(c))}catch(t){return null}}const p={};class l{constructor(){this.client=null;this.experiments=[]}async init(){if(r.isABTestingToggleActive()){try{await this.setClient();await this.loadExperiments()}catch(t){a.error("Could not initialize AbTesting",t)}}}execute(t){if(r.isABTestingToggleActive()){try{const e=this.getExperiment(t);const n=this.getVariation(e);n.activate()}catch(e){a.error(`Could not execute experiment ${t}`,e)}}}executeContentChange(t){if(r.isABTestingToggleActive()){try{const e=this.getExperiment(t.experienceName);const n=this.getVariation(e);if(n.name==="original"){return t.children}return n.activate()}catch(e){a.error(`Could not execute experiment ${t.experienceName}`,e)}}return t.children}async setClient(){if(this.client)return Promise.resolve(this.client);await this.injectScript();const t=window;this.client=t.Matomo;return this.client}async loadExperiments(){const t=this.getClient();const e=t.AbTesting.Experiment;const n=this.getAbTestingDefinitions();for(const t in n){const s=n[t];const o=new e(s);this.experiments.push(o)}}async loadContentGeneratorExperiments(){if(r.isABTestingToggleActive()){const t=this.getClient();const e=t.AbTesting.Experiment;const n=s.state.abExperiences;if(n){for(const t of n){const n=t.variations.map((t=>({name:t.name,activate:()=>t.children})));n.push({name:"original",activate:()=>null});const s=new e(Object.assign(Object.assign({},t),{variations:n}));this.experiments.push(s)}}}}getExperiment(t){const s=this.experiments.find((e=>e.name===t));if(!s)throw new e(`No experiment with name: ${t} found`,n.GENERAL);return s}getVariation(t){const s=t.getActivatedVariationName();const o=t.variations.find((t=>t.name===s));if(!o)throw new e(`No variation in experiment: ${t.name} with name: ${s} found`,n.GENERAL);return o}getClient(){if(!this.client)throw new e("No client is set, you must call init first",n.GENERAL);return this.client}injectScript(){return new Promise(((t,s)=>{const o=document.createElement("script");o.text=this.getMatomoScript();document.head.appendChild(o);const i=u(document.querySelector('script[src="//cdn.matomo.cloud/porsche.matomo.cloud/matomo.js"]'));if(i){i.onload=()=>{t(true)};i.onerror=()=>s(new e("Could not inject Matomo script",n.GENERAL))}else{s(new e("There is no HTML Script element available",n.GENERAL))}}))}getAbTestingDefinitions(){return p}getMatomoScript(){const t=o.state.env;return`var _paq = window._paq = window._paq || [];\n    _paq.push(['trackPageView']);\n    _paq.push(['enableLinkTracking']);\n    (function() {\n      var u="https://porsche.matomo.cloud/";\n      _paq.push(['setTrackerUrl', u+'matomo.php']);\n      _paq.push(['setSiteId', ${t==="production"?"7":"8"}]);\n      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];\n      g.async=true; g.src='//cdn.matomo.cloud/porsche.matomo.cloud/matomo.js'; s.parentNode.insertBefore(g,s);\n    })\n   ();`}}const d=new l;function f(){return d}export{f as a,m as d};
//# sourceMappingURL=p-65f8994f.js.map